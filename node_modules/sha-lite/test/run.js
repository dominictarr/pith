process.chdir( process.argv[1].replace(/[^/]+$/, "") )

require("../sha-lite.js")


var found = 0
, failed = []
, out = 
	[ "abc".sha1() , "a9993e364706816aba3e25717850c26c9cd0d89d"
	, "abc1ö".sha1() , "ed9006416a835d01c054c9272c52a1885571a9fc"
	, "kkkkkkkkkkkkkkkkkkkkkkkkk".sha1() , "005cb6065579bb259bdc966dcc3d800b4c0e631b"
	, "efgfsfgjfkdslkeföl".sha1() , "3228c5ff9b3f008816452fd2c55b6063abfcebf3"

	, "abc".sha256() , "ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad"
	, "abc1ö".sha256() , "555944eb51d8305f11989edc037c0a0fa9999b470c327b3940377fd2c6507ab3"

	, "q".hmac_sha1("w") , "697e084de5f14b207f78bd51e748fdd625e5d4e3"
	, "8d48be98c11eb482f08afbce6d1902b0f0c028f987d58a595fd7fbf365a3dcc95".hmac_sha1("w23e") , "d2308ef241f9163aa65105959600f870f8c0e60b"

	, "q".hmac_sha256("w") , "aa0faac9b60e5d328675f33221327654ad791e2935a4ae12e94c1ac939afdf22"
	, "8d48be98c11eb482f08afbce6d1902b0f0c028f987d58a595fd7fbf365a3dcc95".hmac_sha256("w23e") , "1769221eb6c4f6e52bed133c64d1ba118ef72bfaf91b39f065e0aa43a4788031"

	, "password".pbkdf2_sha1("salt", 1) , "0c60c80f961f0e71f3a9b524af6012062fe037a6"
	, "password".pbkdf2_sha1("salt", 2) , "ea6c014dc72d6f8ccd1ed92ace1d41f0d8de8957"
	]

for (var i = 0, len = out.length; i < len; ) {
	found++
	if (out[i++] != out[i++]) failed.push(out[i-2] + " != " + out[i-1])
}

console.log(found + " tests found, " + failed.length + " failed.")
if (failed.length) throw failed.join("\n")

